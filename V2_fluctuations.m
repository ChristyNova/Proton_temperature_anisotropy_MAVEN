% V2 fluctuations

%load('/Users/chle4971/Google Drive/LASP/MARS/Turbulence/Mars_turbulence_statistics/matlab_turbulence_stats_vars/B_2020_09_01.mat','-mat');
% For MacL2779:
% load('/Users/chle4971/My Drive/LASP/MARS/Turbulence/Mars_turbulence_statistics/matlab_turbulence_stats_vars/mvn_swe_spec_dens.mat','-mat');
% load('/Users/chle4971/My Drive/LASP/MARS/Turbulence/Mars_turbulence_statistics/matlab_turbulence_stats_vars/mvn_lpw_pas_V2.mat','-mat');

% For MacL4326:
load('/Users/chle4971/Google Drive/LASP/MARS/Turbulence/Mars_turbulence_statistics/matlab_turbulence_stats_vars/mvn_swe_spec_dens.mat','-mat');
load('/Users/chle4971/Google Drive/LASP/MARS/Turbulence/Mars_turbulence_statistics/matlab_turbulence_stats_vars/mvn_lpw_pas_V2.mat','-mat');


SW_times =[datetime(2020,09,01,01,45,00),datetime(2020,09,01,02,30,00),...
datetime(2020,09,01,02,30,00),datetime(2020,09,01,02,50,00),...
datetime(2020,09,01,05,20,00),datetime(2020,09,01,06,30,00),...
datetime(2020,09,01,12,40,00),datetime(2020,09,01,13,45,00),...
datetime(2020,09,01,16,20,00),datetime(2020,09,01,16,45,00),...
datetime(2020,09,01,23,15,00),datetime(2020,09,01,23,45,00),...
datetime(2020,09,02,03,10,00),datetime(2020,09,02,04,05,00),...
datetime(2020,09,02,06,40,00),datetime(2020,09,02,07,40,00),...
datetime(2020,09,02,10,20,00),datetime(2020,09,02,11,20,00),...
datetime(2020,09,02,14,30,00),datetime(2020,09,02,15,00,00),...
datetime(2020,09,02,16,00,00),datetime(2020,09,02,16,30,00),...
datetime(2020,09,03,00,40,00),datetime(2020,09,03,01,20,00),...
datetime(2020,09,03,04,10,00),datetime(2020,09,03,04,35,00),...
datetime(2020,09,03,07,40,00),datetime(2020,09,03,08,50,00),...
datetime(2020,09,03,15,55,00),datetime(2020,09,03,16,20,00),...
datetime(2020,09,03,19,00,00),datetime(2020,09,03,19,45,00),...
datetime(2020,09,03,22,20,00),datetime(2020,09,03,23,25,00),...
datetime(2020,09,04,02,30,00),datetime(2020,09,04,03,00,00),...
datetime(2020,09,04,09,00,00),datetime(2020,09,04,09,50,00),...
datetime(2020,09,04,12,50,00),datetime(2020,09,04,13,30,00),...
datetime(2020,09,04,20,30,00),datetime(2020,09,04,21,00,00),...
datetime(2020,09,04,23,20,00),datetime(2020,09,05,00,20,00),...
datetime(2020,09,05,06,40,00),datetime(2020,09,05,07,40,00),...
datetime(2020,09,05,10,20,00),datetime(2020,09,05,10,50,00),...
datetime(2020,09,05,17,30,00),datetime(2020,09,05,18,00,00),...
datetime(2020,09,06,00,30,00),datetime(2020,09,06,01,30,00),...
datetime(2020,09,06,04,20,00),datetime(2020,09,06,05,20,00),...
datetime(2020,09,06,11,30,00),datetime(2020,09,06,12,30,00),...
datetime(2020,09,06,18,50,00),datetime(2020,09,06,19,40,00),...
datetime(2020,09,07,13,00,00),datetime(2020,09,07,13,50,00),...
datetime(2020,09,07,20,00,00),datetime(2020,09,07,20,50,00),...
datetime(2020,09,07,23,30,00),datetime(2020,09,07,23,50,00),...
datetime(2020,09,08,03,10,00),datetime(2020,09,08,04,00,00),...
datetime(2020,09,08,06,50,00),datetime(2020,09,08,07,30,00),...
datetime(2020,09,08,10,50,00),datetime(2020,09,08,11,10,00),...
datetime(2020,09,08,21,50,00),datetime(2020,09,08,22,15,00),...
datetime(2020,09,09,01,10,00),datetime(2020,09,09,01,30,00),...
datetime(2020,09,09,08,00,00),datetime(2020,09,09,08,40,00),...
datetime(2020,09,09,11,40,00),datetime(2020,09,09,12,20,00),...
datetime(2020,09,09,15,20,00),datetime(2020,09,09,16,00,00),...
datetime(2020,09,10,05,30,00),datetime(2020,09,10,06,30,00),...
datetime(2020,09,10,09,35,00),datetime(2020,09,10,10,00,00),...
datetime(2020,09,10,12,50,00),datetime(2020,09,10,13,40,00),...
datetime(2020,09,10,16,20,00),datetime(2020,09,10,17,20,00),...
datetime(2020,09,10,19,50,00),datetime(2020,09,10,21,00,00),...
datetime(2020,09,10,23,30,00),datetime(2020,09,11,00,30,00),...
datetime(2020,09,11,03,10,00),datetime(2020,09,11,04,00,00),...
datetime(2020,09,11,07,10,00),datetime(2020,09,11,07,40,00),...
datetime(2020,09,11,10,10,00),datetime(2020,09,11,11,20,00),...
datetime(2020,09,11,21,30,00),datetime(2020,09,11,22,10,00),...
datetime(2020,09,12,00,40,00),datetime(2020,09,12,01,40,00),...
datetime(2020,09,12,15,20,00),datetime(2020,09,12,16,10,00),...
datetime(2020,09,12,18,40,00),datetime(2020,09,12,19,40,00),...
datetime(2020,09,13,01,50,00),datetime(2020,09,13,02,40,00),...
datetime(2020,09,13,16,30,00),datetime(2020,09,13,17,10,00),...
datetime(2020,09,13,20,00,00),datetime(2020,09,13,20,45,00),...
datetime(2020,09,13,23,40,00),datetime(2020,09,14,00,20,00),...
datetime(2020,09,14,03,15,00),datetime(2020,09,14,04,00,00),...
datetime(2020,09,14,07,05,00),datetime(2020,09,14,07,30,00),...
datetime(2020,09,14,14,00,00),datetime(2020,09,14,14,40,00),...
datetime(2020,09,14,17,50,00),datetime(2020,09,14,18,25,00),...
datetime(2020,09,14,21,00,00),datetime(2020,09,14,22,20,00),...
datetime(2020,09,15,00,40,00),datetime(2020,09,15,01,00,00),...
datetime(2020,09,15,08,20,00),datetime(2020,09,15,08,50,00),...
datetime(2020,09,15,11,20,00),datetime(2020,09,15,12,30,00),...
datetime(2020,09,15,15,10,00),datetime(2020,09,15,16,00,00),...
datetime(2020,09,15,18,40,00),datetime(2020,09,15,19,30,00),...
datetime(2020,09,15,22,35,00),datetime(2020,09,15,23,20,00),...
datetime(2020,09,16,01,40,00),datetime(2020,09,16,02,50,00),...
datetime(2020,09,16,16,00,00),datetime(2020,09,16,16,50,00),...
datetime(2020,09,16,19,50,00),datetime(2020,09,16,20,30,00),...
datetime(2020,09,16,23,40,00),datetime(2020,09,17,00,10,00),...
datetime(2020,09,17,03,10,00),datetime(2020,09,17,04,00,00),...
datetime(2020,09,17,10,30,00),datetime(2020,09,17,11,15,00),...
datetime(2020,09,17,13,50,00),datetime(2020,09,17,14,50,00),...
datetime(2020,09,17,21,20,00),datetime(2020,09,17,21,50,00),...
datetime(2020,09,18,01,30,00),datetime(2020,09,18,01,55,00),...
datetime(2020,09,18,04,30,00),datetime(2020,09,18,05,10,00),...
datetime(2020,09,18,08,00,00),datetime(2020,09,18,08,50,00),...
datetime(2020,09,18,11,30,00),datetime(2020,09,18,12,30,00),...
datetime(2020,09,18,15,10,00),datetime(2020,09,18,16,00,00),...
datetime(2020,09,18,19,00,00),datetime(2020,09,18,19,40,00),...
datetime(2020,09,18,22,40,00),datetime(2020,09,18,23,20,00),...
datetime(2020,09,19,09,30,00),datetime(2020,09,19,10,05,00),...
datetime(2020,09,19,13,00,00),datetime(2020,09,19,13,45,00),...
datetime(2020,09,19,16,00,00),datetime(2020,09,19,17,30,00),...
datetime(2020,09,19,19,50,00),datetime(2020,09,19,20,55,00),...
datetime(2020,09,19,23,50,00),datetime(2020,09,20,00,30,00),...
datetime(2020,09,20,03,35,00),datetime(2020,09,20,04,00,00),...
datetime(2020,09,20,07,10,00),datetime(2020,09,20,07,40,00),...
datetime(2020,09,20,10,50,00),datetime(2020,09,20,11,20,00),...
datetime(2020,09,20,14,20,00),datetime(2020,09,20,15,00,00),...
datetime(2020,09,20,21,30,00),datetime(2020,09,20,22,10,00),...
datetime(2020,09,21,04,30,00),datetime(2020,09,21,05,20,00),...
datetime(2020,09,21,08,30,00),datetime(2020,09,21,08,50,00),...
datetime(2020,09,21,11,50,00),datetime(2020,09,21,12,20,00),...
datetime(2020,09,21,15,30,00),datetime(2020,09,21,16,00,00),...
datetime(2020,09,21,22,50,00),datetime(2020,09,21,23,30,00),...
datetime(2020,09,22,13,10,00),datetime(2020,09,22,13,35,00),...
datetime(2020,09,22,20,30,00),datetime(2020,09,22,20,50,00),...
datetime(2020,09,23,00,00,00),datetime(2020,09,23,00,30,00),...
datetime(2020,09,23,21,40,00),datetime(2020,09,23,22,10,00),...
datetime(2020,09,24,01,20,00),datetime(2020,09,24,01,50,00),...
datetime(2020,09,24,05,00,00),datetime(2020,09,24,05,30,00),...
datetime(2020,09,24,15,30,00),datetime(2020,09,24,16,30,00),...
datetime(2020,09,24,19,10,00),datetime(2020,09,24,19,40,00),...
datetime(2020,09,24,23,00,00),datetime(2020,09,24,23,40,00),...
datetime(2020,09,25,02,30,00),datetime(2020,09,25,03,10,00),...
datetime(2020,09,25,10,05,00),datetime(2020,09,25,10,30,00),...
datetime(2020,09,25,13,15,00),datetime(2020,09,25,14,00,00),...
datetime(2020,09,26,03,55,00),datetime(2020,09,26,04,30,00),...
datetime(2020,09,26,14,30,00),datetime(2020,09,26,15,20,00),...
datetime(2020,09,27,01,30,00),datetime(2020,09,27,02,10,00),...
datetime(2020,09,27,05,00,00),datetime(2020,09,27,05,45,00),...
datetime(2020,09,27,09,00,00),datetime(2020,09,27,09,30,00),...
datetime(2020,09,27,12,10,00),datetime(2020,09,27,12,40,00),...
datetime(2020,09,27,15,50,00),datetime(2020,09,27,16,30,00),...
datetime(2020,09,27,19,20,00),datetime(2020,09,27,20,00,00),...
datetime(2020,09,27,23,10,00),datetime(2020,09,27,23,50,00),...
datetime(2020,09,28,06,20,00),datetime(2020,09,28,07,00,00),...
datetime(2020,09,28,17,00,00),datetime(2020,09,28,17,40,00),...
datetime(2020,09,28,21,00,00),datetime(2020,09,28,21,30,00),...
datetime(2020,09,29,00,20,00),datetime(2020,09,29,01,10,00),...
datetime(2020,09,29,03,40,00),datetime(2020,09,29,04,15,00),...
datetime(2020,09,29,14,45,00),datetime(2020,09,29,15,30,00),...
datetime(2020,09,29,16,20,00),datetime(2020,09,29,19,10,00),...
datetime(2020,09,29,22,00,00),datetime(2020,09,29,22,45,00),...
datetime(2020,09,30,01,20,00),datetime(2020,09,30,02,00,00),...
datetime(2020,09,30,05,25,00),datetime(2020,09,30,06,15,00),...
datetime(2020,09,30,08,40,00),datetime(2020,09,30,09,40,00),...
datetime(2020,09,30,12,20,00),datetime(2020,09,30,13,10,00),...
datetime(2020,09,30,16,00,00),datetime(2020,09,30,16,40,00)];
% V2_ave1 =[];
% V2_ave1_t=[];
% Ne_ave1 =[];
% Ne_ave1_t=[];
V2_to_use =[]; % The indices in V2 that match most closely to the SW_Times
Ne_to_use = [];
for uuu=1:2:numel(SW_times)

    V2_to_use_st = knnsearch(V2.V2_time,posixtime(SW_times(uuu)));
    V2_to_use_end = knnsearch(V2.V2_time,posixtime(SW_times(uuu+1)));
    Ne_to_use_st = knnsearch(Ne.Ne_time,posixtime(SW_times(uuu)));
    Ne_to_use_end = knnsearch(Ne.Ne_time,posixtime(SW_times(uuu+1)));

    Ne_to_use = [Ne_to_use ;Ne(Ne_to_use_st:Ne_to_use_end,:)];
    V2_to_use = [V2_to_use;V2(V2_to_use_st:V2_to_use_end,:)];
% 
%     for i=61:60:numel(V2_to_use.pasV2)-60
%         V2_ave1 = [V2_ave1;mean(V2_to_use.pasV2((i-60):(i+60)),'omitnan')];
%         V2_ave1_t = [V2_ave1_t; V2_to_use.V2_datetime(i)];
%     end 
% 
%     for i=61:60:numel(Ne_to_use.Ne)-60
%         Ne_ave1 = [Ne_ave1;mean(Ne_to_use.Ne((i-60):(i+60)),'omitnan')];
%         Ne_ave1_t = [Ne_ave1_t; Ne_to_use.Ne_datetime(i)];
%     end 
% 
%     Ne_ave = movmean(Ne.Ne,150,'omitnan');
%     Ne_ave_t = movmean(Ne.Ne_time,150);
%     Ne_ave_t_datetime = datetime(Ne_ave_t, 'ConvertFrom','posixtime','Format','yyyy-MM-dd/HH:mm:ss.SSS');
% 
%     V2_ave = movmean(V2.pasV2,300,'omitnan');
%     V2_ave_t = movmean(V2.V2_time,300);
%     V2_ave_t_datetime = datetime(V2_ave_t, 'ConvertFrom','posixtime','Format','yyyy-MM-dd/HH:mm:ss.SSS');
% 
%     dV2 = abs(V2_to_use.pasV2(2:end)-V2_to_use.pasV2(1:end-1));
% 
 end
% 
% dV2_ave = abs(V2_ave.V2_ave(2:end)-V2_ave.V2_ave(1:end-1));
% dV2_over_V2 = dV2_ave./V2_ave.V2_ave(2:end);
% 
% dNe_over_Ne = abs(Ne_ave.Ne_ave(2:end)-Ne_ave.Ne_ave(1:end-1))./Ne_ave.Ne_ave(2:end);
% 
% 
% mvn_fig1 = figure('WindowState','maximized');
% 
% 
%  %% 2 panel plots
% % D_ax = axes('Parent',mvn_fig1,'Position',[0.0723958333333333 0.568089430894309 0.895833333333333 0.415500312695439]);
% % hold(D_ax,'on');
% % D_plot = plot(Ne_ave1.Ne_ave1_t,...
% % Ne_ave1.Ne_ave1,'Parent',D_ax,'LineWidth',1.5,'Marker','o','DisplayName','\rho','Color','k');
% % ylabel({'2min ave electron density','[cm^{-3}]'});
% % box(D_ax,'on');
% % grid(D_ax,'on');
% % set(D_ax,'FontSize',20,'XTickLabel',{'','','','','','','','','',''},'YMinorTick','on');
% % 
% % % %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  
% % % %%% mvn_lpw_pasV2
% % % %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
% % dV2_ax = axes('Parent',mvn_fig1,'Position',[0.0723958333333333 0.100609756097561 0.895833333333333 0.431697936210132]);
% % hold(dV2_ax,'on');
% % V2_plot = plot(V2_ave1.V2_ave1_t,...
% % V2_ave1.V2_ave1,'Parent',dV2_ax,'LineWidth',1.5,'Marker','x','DisplayName','V2','Color','k');
% % ylabel({'2 minute V2 average','[uncorr Volt]'});
% % box(dV2_ax,'on');
% % grid(dV2_ax,'on');
% % %set(V2_ax,'FontSize',14,'XTickLabel',{'','','','','','','','','',''},'YMinorTick','on');
% % set(dV2_ax,'FontSize',20,'YMinorTick','on');
% % % %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  
% % 
% % linkaxes([ D_ax dV2_ax],'x')
% 
%  
%  
%  
%  
% %% 4 panel plots DENSITY, AVE DENSITY, V2, AVE V2
% %   
% % % %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  
% % % % SWEA density plots
% % % %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
% % D_ax = axes('Parent',mvn_fig1,'Position',[0.0681948424068768 0.757948717948718 0.9098827292626 0.225641025641026]);
% % hold(D_ax,'on');
% % D_plot = plot(Ne_ave1.Ne_ave1_t,...
% % Ne_ave1.Ne_ave1,'Parent',D_ax,'LineWidth',1.5,'DisplayName','\rho','Color','k');
% % ylabel({'2min ave electron density','[cm^{-3}]'});
% % box(D_ax,'on');
% % grid(D_ax,'on');
% % set(D_ax,'FontSize',20,'XTickLabel',{'','','','','','','','','',''},'YMinorTick','on');
% % %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  
% % % SWEA average density plots
% % %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
% % Ne_ave_ax = axes('Parent',mvn_fig1,'Position',[0.0681948424068768 0.532307692307692 0.909320615715664 0.225641025641026]);
% % hold(Ne_ave_ax,'on');
% % Ne_ave_plot = plot(Ne_ave_t_datetime,...
% % Ne_ave,'Parent',Ne_ave_ax,'LineWidth',1.5,'DisplayName','\rho','Color','k');
% % ylabel({'average electron density','[cm^{-3}]'});
% % box(Ne_ave_ax,'on');
% % grid(Ne_ave_ax,'on');
% % set(Ne_ave_ax,'FontSize',20,'XTickLabel',{'','','','','','','','','',''},'YMinorTick','on');
% 
% % %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  
% % %%% mvn_lpw_pasV2
% % %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
% % V2_ax = axes('Parent',mvn_fig1,'Position',[0.0681948424068768 0.306666666666667 0.909320615715664 0.225641025641026]);
% % hold(V2_ax,'on');
% % V2_plot = plot(V2_ave1.V2_ave1_t,...
% % V2_ave1.V2_ave1,'Parent',V2_ax,'LineWidth',1.5,'DisplayName','V2','Color','k');
% % ylabel({'2 minute V2 average','[uncorr Volt]'});
% % box(V2_ax,'on');
% % grid(V2_ax,'on');
% % %set(V2_ax,'FontSize',14,'XTickLabel',{'','','','','','','','','',''},'YMinorTick','on');
% % set(V2_ax,'FontSize',20,'YMinorTick','on');
% % %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  
% % 
% % %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  
% % %%% averaged V2
% % %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
% % V2_ave_ax = axes('Parent',mvn_fig1,'Position',[0.0681948424068768 0.081025641025641 0.9106239460371 0.225641025641026]);
% % hold(V2_ave_ax,'on');
% % V2_ave_plot = plot(V2_ave_t_datetime,...
% % V2_ave,'Parent',V2_ave_ax,'LineWidth',1.5,'DisplayName','V2_ave','Color','k');
% % ylabel({'average V2','[uncorr Volt]'});
% % box(V2_ave_ax,'on');
% % grid(V2_ave_ax,'on');
% % %set(V2_ave_ax,'FontSize',14,'XTickLabel',{'','','','','','','','','',''},'YMinorTick','on');
% % set(V2_ave_ax,'FontSize',20,'YMinorTick','on');
% % %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%    
% % linkaxes([ D_ax Ne_ave_ax V2_ax V2_ave_ax],'x')
% %     
% % V2_ax.XLim = [V2.V2_datetime(V2_to_use_st) V2.V2_datetime(V2_to_use_end)];
% 
% 
% 
% %% 4 panel plots 2min AVE DENSITY, 2MIN AVE V2, DV2, DV2/V2
%   
% % %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  
% % % 2 min average SWEA density plots
% % %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
% ave_Ne_ax = axes('Parent',mvn_fig1,'Position',[0.0681948424068768 0.757948717948718 0.9098827292626 0.225641025641026]);
% ave_Ne_ax.TickLabelInterpreter = 'latex'; 
% hold(ave_Ne_ax,'on');
% D_plot = plot(Ne_ave.Ne_ave_t,...
% Ne_ave.Ne_ave,'Parent',ave_Ne_ax,'Marker','x','LineWidth',1.5,'DisplayName','\rho','Color','k');
% ylabel({'2min mean $N_e$'},'Interpreter','latex');
% box(ave_Ne_ax,'on');
% grid(ave_Ne_ax,'on');
% set(ave_Ne_ax,'FontSize',20,'XTickLabel',{'','','','','','','','','',''},'YMinorTick','on');
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  
% % 2min average V2 plots
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
% ave_V2_ax = axes('Parent',mvn_fig1,'Position',[0.0681948424068768 0.532307692307692 0.909320615715664 0.225641025641026]);
% ave_V2_ax.TickLabelInterpreter = 'latex'; 
% hold(ave_V2_ax,'on');
% V2_ave_plot = plot(V2_ave.V2_ave_t,...
% V2_ave.V2_ave,'Parent',ave_V2_ax,'Marker','o','LineWidth',1.5,'DisplayName','\rho','Color','k');
% ylabel({'2min mean V2','[uncorr Volt]'},'Interpreter','latex');
% box(ave_V2_ax,'on');
% grid(ave_V2_ax,'on');
% set(ave_V2_ax,'FontSize',20,'XTickLabel',{'','','','','','','','','',''},'YMinorTick','on');
% 
% % %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  
% % %%% dV2_ave
% % %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
% % dV2_ax = axes('Parent',mvn_fig1,'Position',[0.0681948424068768 0.306666666666667 0.909320615715664 0.225641025641026]);
% % dV2_ax.TickLabelInterpreter = 'latex'; 
% % hold(dV2_ax,'on');
% % dV2_plot = plot(V2_ave.V2_ave_t(2:end),...
% % dV2_ave,'Parent',dV2_ax,'Marker','o','LineWidth',1.5,'DisplayName','V2','Color','k');
% % ylabel({'$\delta V2$ '},'Interpreter','latex');
% % box(dV2_ax,'on');
% % grid(dV2_ax,'on');
% % set(dV2_ax,'FontSize',14,'XTickLabel',{'','','','','','','','','',''},'YMinorTick','on');
% % set(dV2_ax,'FontSize',20,'YMinorTick','on');
% % %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  
% % %%% dNe/Ne
% % %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
% dNe_over_Ne_ax = axes('Parent',mvn_fig1,'Position',[0.0681948424068768 0.306666666666667 0.909320615715664 0.225641025641026]);
% dNe_over_Ne_ax.TickLabelInterpreter = 'latex'; 
% 
% hold(dNe_over_Ne_ax,'on');
% dV2_over_V2_plot = plot(Ne_ave.Ne_ave_t(2:end),...
% dNe_over_Ne,'Parent',dNe_over_Ne_ax,'Marker','x','LineWidth',1.5,'Color','k');
% ylabel({'$\delta N_e/N_e$'},'Interpreter','latex');
% box(dNe_over_Ne_ax,'on');
% grid(dNe_over_Ne_ax,'on');
% set(dNe_over_Ne_ax,'FontSize',20,'XTickLabel',{'','','','','','','','','',''},'YMinorTick','on');
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  
% 
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  
% %%% dV2/V2
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
% dV2_over_V2_ax = axes('Parent',mvn_fig1,'Position',[0.0681948424068768 0.081025641025641 0.9106239460371 0.225641025641026]);
% dV2_over_V2_ax.TickLabelInterpreter = 'latex'; 
% 
% hold(dV2_over_V2_ax,'on');
% dV2_over_V2_plot = plot(V2_ave.V2_ave_t(2:end),...
% dV2_over_V2,'Parent',dV2_over_V2_ax,'Marker','o','LineWidth',1.5,'DisplayName','V2_ave','Color','k');
% ylabel({'$\delta V2/V2$'},'Interpreter','latex');
% box(dV2_over_V2_ax,'on');
% grid(dV2_over_V2_ax,'on');
% %set(V2_ave_ax,'FontSize',14,'XTickLabel',{'','','','','','','','','',''},'YMinorTick','on');
% set(dV2_over_V2_ax,'FontSize',20,'YMinorTick','on');
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%    
% linkaxes([ ave_Ne_ax ave_V2_ax dV2_ax dV2_over_V2_ax],'x')
%     
% 
